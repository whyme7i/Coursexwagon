<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>C.X PRIVATE FORUM</title>
<style>
  body {
    margin:0;
    padding:0;
    font-family: 'Courier New', monospace;
    background:#111;
    color: gold;
    overflow-x: hidden;
  }

  header {
    position: fixed;
    top:0; left:0; right:0;
    height: 70px;
    background: #000;
    border-bottom: 2px solid gold;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.8rem;
    font-weight: bold;
    z-index: 1000;
    animation: pulse 2s infinite alternate;
  }
  @keyframes pulse {
    0%{text-shadow:0 0 5px gold;}
    50%{text-shadow:0 0 20px #fff;}
    100%{text-shadow:0 0 40px gold;}
  }

  #sidebarToggle {
    position: fixed;
    top: 15px;
    left: 15px;
    z-index: 1100;
    background: #111;
    border: 2px solid gold;
    padding: 10px 14px;
    cursor: pointer;
    font-weight: bold;
    color: gold;
    border-radius: 6px;
    transition: 0.3s;
  }
  #sidebarToggle:hover { background: gold; color:#111; }

  #sidebar {
    position: fixed;
    top:0;
    left: -200px;
    width: 200px;
    height: 100vh;
    background: #111;
    border-right: 2px solid gold;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding-top: 80px;
    gap: 20px;
    transition: left 0.3s ease;
    z-index: 1050;
  }
  #sidebar.open { left:0; }

  #sidebar button {
    width: 80%;
    padding: 12px;
    font-size: 1rem;
    font-weight: bold;
    border: 2px solid gold;
    border-radius: 8px;
    background:#111;
    color: gold;
    cursor: pointer;
    transition: 0.3s;
  }
  #sidebar button:hover { background: gold; color:#111; }

  main {
    margin-top: 80px;
    padding: 20px;
  }

  .forum-thread {
    background:#222;
    border:2px solid gold;
    border-radius:10px;
    margin-bottom:20px;
    padding:15px;
    box-shadow:0 0 10px gold;
    transition: 0.3s;
    cursor:pointer;
    animation: appear 1s ease-in-out;
  }
  .forum-thread:hover { box-shadow:0 0 20px #fff; }

  .thread-title {
    font-size:1.3rem;
    font-weight:bold;
    margin-bottom:8px;
    color: gold;
  }
  .thread-admin { font-size:0.9rem; color:#ccc; margin-bottom:5px; }
  .thread-desc { font-size:1rem; color:#ccc; }

  @keyframes appear { from {opacity:0; transform: translateY(-10px);} to {opacity:1; transform: translateY(0);} }

  /* Overlay for sidebar closing */
  #overlay {
    position:fixed;
    top:0; left:0;
    width:100vw;
    height:100vh;
    background:rgba(0,0,0,0.8);
    opacity:0;
    visibility:hidden;
    transition:0.3s;
    z-index:1040;
  }
  #overlay.active { opacity:1; visibility:visible; }
</style>
</head>
<body>

<header>C.X PRIVATE FORUM</header>
<button id="sidebarToggle">MENU</button>
<div id="sidebar">
  <button onclick="window.location.href='admin.html'">Admin Page</button>
  <button onclick="window.location.href='chatroom.html'">Chatroom</button>
</div>
<div id="overlay"></div>

<main id="forumContainer">
  <!-- Threads will be injected here -->
</main>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-firestore.js";

// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyDXEKOmJdN8lzvnUIAhVpzarXvgxanRYgs",
  authDomain: "coursexwagon-admins.firebaseapp.com",
  projectId: "coursexwagon-admins",
  storageBucket: "coursexwagon-admins.firebasestorage.app",
  messagingSenderId: "1081264056319",
  appId: "1:1081264056319:web:99c2814d8e83571c16e9ca",
  measurementId: "G-SR53N510NN"
};
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// Sidebar toggle
const sidebarToggle = document.getElementById('sidebarToggle');
const sidebar = document.getElementById('sidebar');
const overlay = document.getElementById('overlay');
sidebarToggle.addEventListener('click', ()=>{
  sidebar.classList.toggle('open');
  overlay.classList.toggle('active');
});
overlay.addEventListener('click', ()=>{
  sidebar.classList.remove('open');
  overlay.classList.remove('active');
});

// Load forum threads
async function loadThreads(){
  const container = document.getElementById('forumContainer');
  container.innerHTML = '';
  const snapshot = await getDocs(collection(db,"threads"));
  snapshot.forEach(docSnap=>{
    const data = docSnap.data();
    const threadDiv = document.createElement('div');
    threadDiv.className = 'forum-thread';
    threadDiv.innerHTML = `
      <div class="thread-title">${data.title}</div>
      <div class="thread-admin">Posted by: ${data.admin}</div>
      <div class="thread-desc">${data.desc}</div>
    `;
    threadDiv.onclick = ()=> {
      window.open("", "_blank").document.write(`
        <html><head><title>${data.title}</title>
        <style>body{background:#111;color:gold;font-family:'Courier New',monospace;padding:30px;} a{color:#ccc;}</style>
        </head>
        <body>
          <h1>${data.title}</h1>
          <p>Posted by: ${data.admin}</p>
          <p>${data.desc}</p>
          <a href="${data.url}" target="_blank">Download Link</a>
        </body>
        </html>
      `);
    };
    container.appendChild(threadDiv);
  });
}

window.onload = loadThreads;
</script>

</body>
</html>
