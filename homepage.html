<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>C.X PRIVATE FORUM</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Courier New', monospace;background:#000;color:#d4af37;overflow-x:hidden;}
header{position:fixed;top:0;left:0;right:0;height:60px;background:#111;display:flex;align-items:center;justify-content:center;font-weight:900;font-size:1.5rem;z-index:1000;letter-spacing:0.1em;border-bottom:2px solid #d4af37;}
#sidebarToggle{position:fixed;top:10px;left:10px;background:#111;border:2px solid #d4af37;padding:10px 15px;cursor:pointer;z-index:1100;}
#sidebar{position:fixed;top:0;left:-250px;width:250px;height:100vh;background:#111;padding:70px 15px;display:flex;flex-direction:column;gap:20px;transition:left 0.3s ease;z-index:1099;}
#sidebar button{padding:10px;font-weight:700;cursor:pointer;border:none;border-radius:5px;background:#d4af37;color:#111;transition:0.3s;}
#sidebar button:hover{background:#fff;color:#000;}
#overlay{position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.9);opacity:0;visibility:hidden;transition:0.3s;z-index:1098;}
#overlay.active{opacity:1; visibility:visible;}
main{max-width:1200px;margin:80px auto 50px;padding:0 15px;display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:20px;}
.thread{background:#111;padding:15px;border:2px solid #d4af37;border-radius:10px;box-shadow:0 0 15px #d4af37;transition:0.3s;position:relative;cursor:pointer;}
.thread:hover{box-shadow:0 0 25px #fff;animation:shake 0.3s;}
.thread h3{margin-bottom:10px;}
.thread p{margin-bottom:10px;}
.delete-btn{position:absolute;top:10px;right:10px;background:red;color:#fff;border:none;border-radius:5px;cursor:pointer;padding:5px 8px;}
.search-bar{width:100%;margin-bottom:20px;padding:10px;font-size:16px;border-radius:5px;border:1px solid #d4af37;background:#000;color:#d4af37;}
@keyframes shake{
0%{transform:translate(0px,0px);}
25%{transform:translate(2px,0px);}
50%{transform:translate(-2px,0px);}
75%{transform:translate(2px,0px);}
100%{transform:translate(0px,0px);}
}
</style>
</head>
<body>
<header>C.X PRIVATE FORUM</header>
<button id="sidebarToggle">MENU</button>
<div id="sidebar">
  <button onclick="location.href='chatroom.html'">Chatroom</button>
  <button onclick="location.href='admins.html'">Admins Panel</button>
</div>
<div id="overlay"></div>

<main>
  <input type="text" class="search-bar" placeholder="Search threads..." id="searchInput">
  <div id="threadsContainer"></div>
</main>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
import { getFirestore, collection, getDocs, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-firestore.js";

// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyDXEKOmJdN8lzvnUIAhVpzarXvgxanRYgs",
  authDomain: "coursexwagon-admins.firebaseapp.com",
  projectId: "coursexwagon-admins",
  storageBucket: "coursexwagon-admins.firebasestorage.app",
  messagingSenderId: "1081264056319",
  appId: "1:1081264056319:web:99c2814d8e83571c16e9ca",
  measurementId: "G-SR53N510NN"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// Sidebar toggle
const sidebarToggle = document.getElementById('sidebarToggle');
const sidebar = document.getElementById('sidebar');
const overlay = document.getElementById('overlay');

sidebarToggle.addEventListener('click',()=>{
  sidebar.classList.toggle('open');
  overlay.classList.toggle('active');
});
overlay.addEventListener('click',()=>{
  sidebar.classList.remove('open');
  overlay.classList.remove('active');
});

const threadsContainer = document.getElementById('threadsContainer');
const searchInput = document.getElementById('searchInput');

async function loadThreads(){
  threadsContainer.innerHTML="";
  const snapshot = await getDocs(collection(db,"threads"));
  snapshot.forEach(docSnap=>{
    const t = docSnap.data();
    const div = document.createElement('div');
    div.className="thread";
    div.innerHTML=`<h3>${t.title}</h3>
                   <p>${t.desc}</p>
                   <p>Posted by: ${t.admin}</p>
                   <a href="${t.url}" target="_blank">Download Link</a>
                   <button class="delete-btn">Delete</button>`;
    const deleteBtn = div.querySelector('.delete-btn');
    deleteBtn.onclick=async(e)=>{
      e.stopPropagation();
      const adminName = prompt("Enter Admin Name:");
      const adminPass = prompt("Enter Admin Password:");
      if((adminName==="Ignacio Chamboko" || adminName==="Don Kyono") && adminPass==="God+Word"){
        if(confirm("Confirm delete?")){
          await deleteDoc(doc(db,"threads",docSnap.id));
          div.remove();
          alert("Thread deleted successfully!");
        }
      } else {
        alert("☠️ Access Denied! Hacking attempt detected!");
        localStorage.removeItem("currentUser");
        window.location.href="index.html";
      }
    }
    div.onclick=()=>{alert("Hacking animation simulation: Opening thread...")};
    threadsContainer.appendChild(div);
  });
}

// Real-time search
searchInput.addEventListener('input',()=>{
  const val = searchInput.value.toLowerCase();
  document.querySelectorAll('.thread').forEach(t=>{
    const text = t.innerText.toLowerCase();
    t.style.display=text.includes(val)?"block":"none";
  });
});

window.onload=loadThreads;
</script>
</body>
</html>
