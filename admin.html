<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>C.X ADMINS PANEL</title>
<style>
  *{margin:0;padding:0;box-sizing:border-box;}
  body{
    font-family:'Courier New', monospace;
    background:#000;
    color:#d4af37;
    overflow-x:hidden;
  }
  header{
    position:fixed; top:0; left:0; right:0; height:60px;
    background:#111; display:flex; align-items:center; justify-content:center;
    font-weight:900; font-size:1.5rem; z-index:1000;
    letter-spacing:0.1em; border-bottom:2px solid #d4af37;
    text-shadow:0 0 8px #d4af37;
  }
  main{
    margin-top:80px; max-width:800px; padding:15px; margin-left:auto;margin-right:auto;
  }
  input, textarea{
    width:100%; padding:10px; margin-bottom:15px;
    border:2px solid #d4af37; border-radius:8px;
    background:#111; color:#d4af37; font-size:1rem;
    box-shadow:0 0 8px #d4af37 inset;
  }
  button{
    padding:12px 20px; border:none; border-radius:6px;
    background:#d4af37; color:#111; font-weight:700; cursor:pointer;
    font-size:1rem; margin-right:10px;
    transition:0.3s;
  }
  button:hover{background:#fff;color:#000;}
  .thread-box{
    background:#111; border:2px solid #d4af37; padding:15px;
    margin-bottom:20px; border-radius:10px; box-shadow:0 0 15px #d4af37;
    animation: fadeIn 0.7s ease;
    position:relative;
  }
  @keyframes fadeIn{
    from {opacity:0; transform:translateY(20px);}
    to {opacity:1; transform:translateY(0);}
  }
  .locked-comment{
    margin-top:10px; font-style:italic; color:red;
    text-align:center; border-top:1px dashed #d4af37; padding-top:10px;
  }
</style>
</head>
<body>
<header>C.X ADMINS PANEL</header>
<main>
  <h2>Post New Thread</h2>
  <input type="text" id="adminUsername" placeholder="Admin Username">
  <input type="password" id="adminPassword" placeholder="Admin Password">
  <input type="text" id="threadTitle" placeholder="Thread Title">
  <textarea id="threadDesc" rows="4" placeholder="Thread Description"></textarea>
  <input type="text" id="threadURL" placeholder="Thread URL (optional)">
  <input type="text" id="threadEmoji" placeholder="Emoji (optional)">
  <button onclick="postThread()">Post Thread</button>
  <div id="message"></div>

  <h2 style="margin-top:40px;">Posted Threads</h2>
  <div id="postedThreads"></div>
</main>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs, doc, deleteDoc } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDXEKOmJdN8lzvnUIAhVpzarXvgxanRYgs",
  authDomain: "coursexwagon-admins.firebaseapp.com",
  projectId: "coursexwagon-admins",
  storageBucket: "coursexwagon-admins.firebasestorage.app",
  messagingSenderId: "1081264056319",
  appId: "1:1081264056319:web:99c2814d8e83571c16e9ca",
  measurementId: "G-SR53N510NN"
};
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const messageDiv = document.getElementById('message');
const postedThreadsDiv = document.getElementById('postedThreads');

async function loadThreads(){
  postedThreadsDiv.innerHTML="";
  const snapshot = await getDocs(collection(db,"threads"));
  snapshot.forEach(docSnap=>{
    const t = docSnap.data();
    const div = document.createElement('div');
    div.className="thread-box";
    div.innerHTML = `<h3>${t.emoji?t.emoji+" ":""}${t.title}</h3>
                     <p>${t.desc}</p>
                     <p>Posted by: ${t.admin}</p>
                     <a href="${t.url}" target="_blank">${t.url? "Download Link":""}</a>
                     <div class="locked-comment">Comments Locked</div>`;
    postedThreadsDiv.appendChild(div);
  });
}

async function postThread(){
  const username = document.getElementById('adminUsername').value.trim();
  const password = document.getElementById('adminPassword').value.trim();
  const title = document.getElementById('threadTitle').value.trim();
  const desc = document.getElementById('threadDesc').value.trim();
  const url = document.getElementById('threadURL').value.trim();
  const emoji = document.getElementById('threadEmoji').value.trim();

  if(!username || !password || !title || !desc){
    messageDiv.innerText="Fill all required fields!";
    messageDiv.style.color="red";
    return;
  }

  if(!((username==="Don Kyono" || username==="Ignacio Chamboko") && password==="God+Word")){
    messageDiv.innerText="ðŸ’€ You are not an admin! Access denied!";
    messageDiv.style.color="red";
    return;
  }

  try{
    await addDoc(collection(db,"threads"),{
      admin: username,
      title,
      desc,
      url,
      emoji
    });
    messageDiv.innerText="âœ… Thread posted successfully!";
    messageDiv.style.color="gold";
    document.getElementById('threadTitle').value="";
    document.getElementById('threadDesc').value="";
    document.getElementById('threadURL').value="";
    document.getElementById('threadEmoji').value="";
    loadThreads();
  } catch(e){
    console.error(e);
    messageDiv.innerText="Error posting thread!";
    messageDiv.style.color="red";
  }
}

window.onload=loadThreads;
</script>
</body>
</html>
